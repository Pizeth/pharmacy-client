<html>
  <head>
    <!-- <link rel="stylesheet" href="test.css" /> -->
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <style>
      html,
      body,
      .ag-format-container,
      .ag-block {
        height: 100%;
      }
      body {
        overflow: hidden;
      }

      .ag-format-container {
        width: 1142px;
        margin: 0 auto;
      }

      .ag-meteor-block {
        height: 100%;
        width: 100%;
        background-image: url(https://raw.githubusercontent.com/SochavaAG/example-mycode/master/pens/meteors-right/images/bg.jpg);
        background-position: 100% 0;
        background-size: cover;

        pointer-events: none;

        overflow: hidden;

        top: 0;
        left: 0;
      }
      .ag-meteor-block,
      .meteor__item {
        position: absolute;
      }
      .meteor__item-img {
        width: 600px;
        height: 600px;
        background-image: url(https://raw.githubusercontent.com/SochavaAG/example-mycode/master/pens/meteors-right/images/meteors-sprite.png);
        background-size: auto 100%;

        -webkit-animation: an-frame-animation 3s steps(48) infinite;
        -moz-animation: an-frame-animation 3s steps(48) infinite;
        -o-animation: an-frame-animation 3s steps(48) infinite;
        animation: an-frame-animation 3s steps(48) infinite;

        -webkit-transform: rotate(45deg);
        -moz-transform: rotate(45deg);
        -o-transform: rotate(45deg);
        transform: rotate(45deg);
      }

      @-webkit-keyframes an-frame-animation {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: -28800px 0;
        }
      }

      @-moz-keyframes an-frame-animation {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: -28800px 0;
        }
      }

      @-o-keyframes an-frame-animation {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: -28800px 0;
        }
      }

      @keyframes an-frame-animation {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: -28800px 0;
        }
      }

      @media only screen and (max-width: 767px) {
        .ag-format-container {
          width: 96%;
        }
      }

      @media only screen and (max-width: 639px) {
      }

      @media only screen and (max-width: 479px) {
      }

      @media (min-width: 768px) and (max-width: 979px) {
        .ag-format-container {
          width: 750px;
        }
      }

      @media (min-width: 980px) and (max-width: 1161px) {
        .ag-format-container {
          width: 960px;
        }
      }
    </style>
  </head>
  <body>
    <div id="js-meteor-block" class="ag-meteor-block">
      <div class="ag-format-container"></div>
    </div>
  </body>
  <script>
    (function ($) {
      $(function () {
        function index_defineProperties(target, props) {
          for (var i = 0; i < props.length; i++) {
            var descriptor = props[i];
            (descriptor.enumerable = descriptor.enumerable || !1),
              (descriptor.configurable = !0),
              "value" in descriptor && (descriptor.writable = !0),
              Object.defineProperty(target, descriptor.key, descriptor);
          }
        }

        var index_Meteor = (function () {
          function Meteor(options) {
            var _this = this;
            !(function (instance, Constructor) {
              if (!(instance instanceof Constructor))
                throw new TypeError("Cannot call a class as a function");
            })(this, Meteor),
              (this.options = options),
              (this.container = $("#".concat(this.options.container))),
              (this.containerWidth = this.container.width()),
              (this.containerHeight = this.container.height()),
              setInterval(function () {
                _this.init();
              }, 500);
          }

          var Constructor, protoProps, staticProps;
          return (
            (Constructor = Meteor),
            (protoProps = [
              {
                key: "init",
                value: function () {
                  var _this2 = this,
                    id = ""
                      .concat(this.options.container, "_")
                      .concat(this.getRandomInt(0, 10000));
                  if (0 === $("#".concat(id)).length) {
                    var index = this.getRandomInt(
                        0,
                        this.options.meteors.length - 1
                      ),
                      meteor = this.options.meteors[index];
                    if (meteor.count <= meteor.maxCount) {
                      meteor.count++,
                        this.container.append(
                          '\n<div id="'.concat(
                            id,
                            '" class="meteor__item">\n<div class="meteor__item-img"></div>\n</div>\n'
                          )
                        );

                      var topOrLeft = this.getRandomInt(0, 1),
                        top = this.getRandomInt(0, this.containerHeight),
                        left = this.getRandomInt(0, this.containerWidth),
                        zIndex = 10 * meteor.zIndex,
                        size = meteor.size,
                        transition = meteor.speed;

                      $("#".concat(id)).css({
                        left: topOrLeft ? "100%" : "".concat(left, "px"),
                        top: topOrLeft ? "".concat(top + 1000, "px") : 0,
                        transition: "transform ".concat(transition, "s linear"),
                        transform: "translate("
                          .concat(size, "px, -")
                          .concat(size, "px"),
                        "z-index": zIndex,
                      });

                      $("#".concat(id))
                        .find(".meteor__item-img")
                        .css({
                          width: "".concat(size, "px"),
                          height: "".concat(size, "px"),
                        });

                      setTimeout(function () {
                        $("#".concat(id)).css({
                          transform: "translate(-"
                            .concat(
                              _this2.containerHeight - (topOrLeft ? top : 0),
                              "px, "
                            )
                            .concat(
                              _this2.containerHeight - (topOrLeft ? top : 0),
                              "px"
                            ),
                        });
                      }, 100);

                      setTimeout(function () {
                        $("#".concat(id)).remove(), meteor.count--;
                      }, 1000 * transition);
                    }
                  }
                },
              },
              {
                key: "getRandomInt",
                value: function (min, max) {
                  return Math.floor(min + Math.random() * (max + 1 - min));
                },
              },
              {
                key: "isScrolledIntoView",
                value: function (elem) {
                  var docViewTop = $(window).scrollTop(),
                    docViewBottom = docViewTop + $(window).height(),
                    elemTop = elem.offset().top;
                  return (
                    elemTop + elem.height() >= docViewTop &&
                    elemTop <= docViewBottom
                  );
                },
              },
            ]) && index_defineProperties(Constructor.prototype, protoProps),
            staticProps && index_defineProperties(Constructor, staticProps),
            Meteor
          );
        })();

        new index_Meteor({
          container: "js-meteor-block",
          meteors: [
            { size: 600, speed: 5, maxCount: 2, count: 0, zIndex: 10 },
            {
              size: 300,
              speed: 10,
              maxCount: 3,
              count: 0,
              zIndex: 4,
            },
            { size: 150, speed: 15, maxCount: 5, count: 0, zIndex: 0 },
          ],
        });
      });
    })(jQuery);
  </script>
</html>
