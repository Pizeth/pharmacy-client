<!--
Source - https://stackoverflow.com/a
Posted by Diego Betto
Retrieved 2026-01-23, License - CC BY-SA 4.0
-->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        background: #111;
        color: white;
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }

      .container {
        position: relative;
        text-align: center;
      }

      /* The container for the sphere */
      #glass {
        width: 70vmin;
        height: 70vmin;
        border-radius: 50%; /* Circular mask */
        box-shadow:
          inset -20px -20px 50px rgba(0, 0, 0, 0.8),
          /* Shadow */ inset 10px 10px 20px rgba(255, 255, 255, 0.2),
          /* Highlight */ 0 0 15px #000; /* Outer drop shadow */
        overflow: hidden;
        position: relative;
        margin: 0 auto;
        background: #000;
      }

      /* The SVG map itself */
      #glass svg {
        display: block;
        /* position: absolute;
        top: 5vmin;
        left: 5vmin; */
        width: 70vmin;
        height: 70vmin;
      }

      /* #glass svg {
        border: 1px solid transparent;
        border-radius: 50%;
        overflow: hidden;
        z-index: -1;
        position: relative;
      } */

      .controls {
        margin-top: 20px;
        background: #222;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #444;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-size: 0.9em;
        color: #aaa;
      }

      input[type="range"] {
        width: 300px;
        accent-color: #0077be;
      }
    </style>
    <title>Pure SVG Spherical Displacement</title>
  </head>

  <body>
    <div id="glass">
      <svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice">
        <!-- <svg viewBox="0 0 400 400" width="400" height="400"> -->
        <g transform="rotate(23.5, 50, 50)">
          <circle
            cx="50"
            cy="50"
            r="100"
            fill="url(#pattern)"
            filter="url(#conform)"
          />
        </g>
        <defs>
          <filter
            id="conform"
            color-interpolation-filters="sRGB"
            width="1"
            height="1"
            x="0"
            y="0"
          >
            <!-- <feImage
              href="data:image/svg+xml;charset=utf-8,%3Csvg width='100%' height='100%' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='gR' x1='0%25' y1='0%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%23000'/%3E%3Cstop offset='100%25' stop-color='%23f00'/%3E%3C/linearGradient%3E%3ClinearGradient id='gB' x1='0%25' y1='0%25' x2='0%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23000'/%3E%3Cstop offset='100%25' stop-color='%2300f'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23gR)'/%3E%3Crect width='100%25' height='100%25' fill='url(%23gB)' style='mix-blend-mode:screen'/%3E%3C/svg%3E"
              x="0"
              y="0"
              width="100%"
              height="100%"
              preserveAspectRatio="none"
              result="MAP"
            /> -->

            <!-- 
                Improved Spherical Displacement Map:
                We use radial gradients to simulate the non-linear curvature.
                Red (X) and Blue (Y) values increase from the center outwards,
                creating a 'magnifying glass' or 'fish-eye' effect that 
                better approximates a spherical lens.
              -->
            <feImage
              href="data:image/svg+xml;charset=utf-8,%3Csvg width='256' height='256' viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3CradialGradient id='gR' cx='50%25' cy='50%25' r='50%25'%3E%3Cstop offset='0%25' stop-color='%23800000'/%3E%3Cstop offset='100%25' stop-color='%23ff0000'/%3E%3C/radialGradient%3E%3CradialGradient id='gB' cx='50%25' cy='50%25' r='50%25'%3E%3Cstop offset='0%25' stop-color='%23000080'/%3E%3Cstop offset='100%25' stop-color='%230000ff'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23gR)'/%3E%3Crect width='100%25' height='100%25' fill='url(%23gB)' style='mix-blend-mode:screen'/%3E%3C/svg%3E"
              x="0"
              y="0"
              width="100%"
              height="100%"
              preserveAspectRatio="none"
              result="MAP"
            />

            <feDisplacementMap
              id="dispMap"
              in="SourceGraphic"
              in2="MAP"
              scale="-5"
              xChannelSelector="R"
              yChannelSelector="B"
            ></feDisplacementMap>
          </filter>
          <pattern
            id="pattern"
            x="0"
            y="0"
            width="200"
            height="100"
            patternUnits="userSpaceOnUse"
            patternContentUnits="userSpaceOnUse"
          >
            <animate
              attributeName="x"
              from="0"
              to="200"
              dur="10s"
              repeatCount="indefinite"
            />
            <image
              id="map"
              x="0"
              y="0"
              href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Blue_Marble_2002.png/3840px-Blue_Marble_2002.png"
              width="200%"
              height="100%"
              preserveAspectRatio="xMidYMid slice"
            />
          </pattern>
        </defs>
      </svg>
    </div>
    <div class="controls">
      <label for="scaleSlider"
        >Displacement Scale (Negative = Inverted/Pinch)</label
      >
      <input type="range" id="scaleSlider" min="-200" max="200" value="0" />
      <div id="scaleVal">0</div>
    </div>
    <script>
      // Simple script to update the displacement scale
      const slider = document.getElementById("scaleSlider");
      const dispMap = document.getElementById("dispMap");
      const valDisplay = document.getElementById("scaleVal");

      slider.addEventListener("input", (e) => {
        const val = e.target.value;
        console.log("Scale:", val);

        dispMap.setAttribute("scale", val);
        console.log("dispMap:", dispMap);
        valDisplay.textContent = val;
      });
    </script>
    <!-- <style>
      #glass {
        border-radius: 50%;
        width: 400px;
        height: 400px;
        box-shadow: inset 0 0 50px #000000;
      }

      #glass svg {
        border: 1px solid transparent;
        border-radius: 50%;
        overflow: hidden;
        z-index: -1;
        position: relative;
      }
    </style> -->
  </body>
</html>

<!-- <html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pure SVG Spherical Displacement</title>
    <style>
      body {
        background: #111;
        color: white;
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }

      .container {
        position: relative;
        text-align: center;
      }

      /* The container for the sphere */
      #glass {
        width: 400px;
        height: 400px;
        border-radius: 50%; /* Circular mask */
        box-shadow:
          inset -20px -20px 50px rgba(0, 0, 0, 0.8),
          /* Shadow */ inset 10px 10px 20px rgba(255, 255, 255, 0.2),
          /* Highlight */ 0 0 15px #000; /* Outer drop shadow */
        overflow: hidden; /* Clips the square SVG to a circle */
        position: relative;
        margin: 0 auto;
        background: #000;
      }

      /* The SVG map itself */
      #glass svg {
        display: block;
        width: 100vmin;
        height: 100vmin;
      }

      /* #glass svg {
        border: 1px solid transparent;
        border-radius: 50%;
        overflow: hidden;
        z-index: -1;
        position: relative;
      } */

      .controls {
        margin-top: 20px;
        background: #222;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #444;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-size: 0.9em;
        color: #aaa;
      }

      input[type="range"] {
        width: 300px;
        accent-color: #0077be;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div id="glass">
        <svg viewBox="0 0 400 400" preserveAspectRatio="xMidYMid slice">
          <defs>
            <filter id="conform">
              <feImage
                href="data:image/svg+xml;charset=utf-8,%3Csvg width='256' height='256' viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='gR' x1='0%25' y1='0%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%23000'/%3E%3Cstop offset='100%25' stop-color='%23f00'/%3E%3C/linearGradient%3E%3ClinearGradient id='gB' x1='0%25' y1='0%25' x2='0%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23000'/%3E%3Cstop offset='100%25' stop-color='%2300f'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23gR)'/%3E%3Crect width='100%25' height='100%25' fill='url(%23gB)' style='mix-blend-mode:screen'/%3E%3C/svg%3E"
                x="0"
                y="0"
                width="100%"
                height="100%"
                preserveAspectRatio="none"
                result="MAP"
              />

              <feDisplacementMap
                id="dispMap"
                in="SourceGraphic"
                in2="MAP"
                scale="100"
                xChannelSelector="R"
                yChannelSelector="B"
              />
            </filter>
          </defs>

          <image
            id="map"
            href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Blue_Marble_2002.png/3840px-Blue_Marble_2002.png"
            filter="url(#conform)"
            width="200%"
            height="100%"
          />
        </svg>
      </div>

      <div class="controls">
        <label for="scaleSlider"
          >Displacement Scale (Negative = Inverted/Pinch)</label
        >
        <input type="range" id="scaleSlider" min="-200" max="200" value="100" />
        <div id="scaleVal">100</div>
      </div>
    </div>

    <script>
      // Simple script to update the displacement scale
      const slider = document.getElementById("scaleSlider");
      const dispMap = document.getElementById("dispMap");
      const valDisplay = document.getElementById("scaleVal");

      slider.addEventListener("input", (e) => {
        const val = e.target.value;
        dispMap.setAttribute("scale", val);
        valDisplay.textContent = val;
      });
    </script>
  </body>
</html> -->
