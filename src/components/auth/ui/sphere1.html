<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Pure SVG Realistic Spherical Earth (Axial Tilt + Balanced Lighting)
    </title>
    <style>
      body {
        background: #111;
        color: white;
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
      }

      .container {
        position: relative;
        text-align: center;
      }

      #glass {
        width: 400px;
        height: 400px;
        border-radius: 50%;
        box-shadow:
          inset -20px -20px 50px rgba(0, 0, 0, 0.8),
          inset 10px 10px 20px rgba(255, 255, 255, 0.2),
          0 0 15px #000;
        overflow: hidden;
        position: relative;
        margin: 0 auto;
        background: #000;
      }

      #glass svg {
        display: block;
        width: 100%;
        height: 100%;
      }

      .controls {
        margin-top: 20px;
        background: #222;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #444;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-size: 0.9em;
        color: #aaa;
      }

      input[type="range"] {
        width: 300px;
        accent-color: #0077be;
      }

      button {
        background: #0077be;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
      }

      button:hover {
        background: #005fa3;
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.4;
        }
        50% {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="glass">
        <svg viewBox="0 0 400 400" preserveAspectRatio="xMidYMid slice">
          <defs>
            <!-- Ground displacement map -->
            <filter id="conform">
              <feImage
                href="data:image/svg+xml;charset=utf-8,%3Csvg width='256' height='256' viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='horiz' x1='0%25' x2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ff0000'/%3E%3Cstop offset='50%25' stop-color='%23808080'/%3E%3Cstop offset='100%25' stop-color='%23000000'/%3E%3C/linearGradient%3E%3ClinearGradient id='vertmod' y1='0%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ffffff'/%3E%3Cstop offset='35%25' stop-color='%23404040'/%3E%3Cstop offset='65%25' stop-color='%23404040'/%3E%3Cstop offset='100%25' stop-color='%23ffffff'/%3E%3C/linearGradient%3E%3CradialGradient id='radmod' cx='50%25' cy='50%25' r='50%25'%3E%3Cstop offset='0%25' stop-color='%23404040'/%3E%3Cstop offset='100%25' stop-color='%23ffffff'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23horiz)'/%3E%3Crect width='100%25' height='100%25' fill='url(%23vertmod)' style='mix-blend-mode:multiply'/%3E%3Crect width='100%25' height='100%25' fill='url(%23radmod)' style='mix-blend-mode:multiply'/%3E%3Crect width='100%25' height='100%25' fill='%23000080' style='mix-blend-mode:screen'/%3E%3C/svg%3E"
                x="0"
                y="0"
                width="100%"
                height="100%"
                preserveAspectRatio="none"
                result="MAP"
              />
              <feDisplacementMap
                id="dispMap"
                in="SourceGraphic"
                in2="MAP"
                scale="55"
                xChannelSelector="R"
                yChannelSelector="B"
              />
            </filter>

            <!-- Clouds displacement (weaker for parallax) -->
            <filter id="cloudsConform">
              <feImage
                href="data:image/svg+xml;charset=utf-8,%3Csvg width='256' height='256' viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='horiz' x1='0%25' x2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ff0000'/%3E%3Cstop offset='50%25' stop-color='%23808080'/%3E%3Cstop offset='100%25' stop-color='%23000000'/%3E%3C/linearGradient%3E%3ClinearGradient id='vertmod' y1='0%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ffffff'/%3E%3Cstop offset='35%25' stop-color='%23404040'/%3E%3Cstop offset='65%25' stop-color='%23404040'/%3E%3Cstop offset='100%25' stop-color='%23ffffff'/%3E%3C/linearGradient%3E%3CradialGradient id='radmod' cx='50%25' cy='50%25' r='50%25'%3E%3Cstop offset='0%25' stop-color='%23404040'/%3E%3Cstop offset='100%25' stop-color='%23ffffff'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23horiz)'/%3E%3Crect width='100%25' height='100%25' fill='url(%23vertmod)' style='mix-blend-mode:multiply'/%3E%3Crect width='100%25' height='100%25' fill='url(%23radmod)' style='mix-blend-mode:multiply'/%3E%3Crect width='100%25' height='100%25' fill='%23000080' style='mix-blend-mode:screen'/%3E%3C/svg%3E"
                x="0"
                y="0"
                width="100%"
                height="100%"
                preserveAspectRatio="none"
                result="MAP"
              />
              <feDisplacementMap
                id="cloudDisp"
                in="SourceGraphic"
                in2="MAP"
                scale="44"
                xChannelSelector="R"
                yChannelSelector="B"
              />
            </filter>

            <!-- Subtle glow blur for city lights -->
            <!-- <filter
              id="lightsBlur"
              x="-50%"
              y="-50%"
              width="200%"
              height="200%"
            >
              <feGaussianBlur stdDeviation="4" />
            </filter> -->

            <!-- Limb darkening -->
            <!-- <radialGradient id="limbGrad">
              <stop offset="0%" stop-color="#ffffff" />
              <stop offset="100%" stop-color="#000000" stop-opacity="0.35" />
            </radialGradient> -->

            <!-- Specular highlight (matched to sun position) -->
            <radialGradient id="specGrad" cx="50%" cy="40%">
              <stop offset="0%" stop-color="#ffffff" stop-opacity="0.7" />
              <stop offset="40%" stop-color="#ffffff" stop-opacity="0.15" />
              <stop offset="100%" stop-color="#ffffff" stop-opacity="0" />
            </radialGradient>
            <filter id="specBlur">
              <feGaussianBlur stdDeviation="30" />
            </filter>

            <!-- Atmospheric glow -->
            <radialGradient id="atmoGrad">
              <stop offset="90%" stop-color="transparent" />
              <stop offset="97%" stop-color="#88ccff" stop-opacity="0.3" />
              <stop offset="100%" stop-color="#4488ff" stop-opacity="0.7" />
            </radialGradient>
            <filter id="atmoBlur" x="-50%" y="-50%" width="200%" height="200%">
              <feGaussianBlur stdDeviation="15" />
            </filter>

            <!-- Day/night terminator – now nearly full day with small soft night area -->
            <radialGradient id="nightGrad" cx="50%" cy="40%">
              <stop offset="0%" stop-color="#000000" stop-opacity="0" />
              <stop offset="80%" stop-color="#000000" stop-opacity="0" />
              <stop offset="100%" stop-color="#000000" stop-opacity="0.75" />
            </radialGradient>
            <filter id="terminatorBlur">
              <feGaussianBlur stdDeviation="50" />
            </filter>
          </defs>

          <!-- Base Earth map (day) – shifted vertically for axial tilt (~23.4°) -->
          <image
            id="map"
            href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Blue_Marble_2002.png/3840px-Blue_Marble_2002.png"
            filter="url(#conform)"
            x="-100%"
            y="-13%"
            width="200%"
            height="100%"
            preserveAspectRatio="none"
          />

          <!-- Clouds -->
          <image
            id="clouds"
            href="https://upload.wikimedia.org/wikipedia/commons/d/df/Earth-clouds.png"
            filter="url(#cloudsConform)"
            x="-100%"
            y="-13%"
            width="200%"
            height="100%"
            preserveAspectRatio="none"
            style="mix-blend-mode: screen"
          />

          <!-- Day/night terminator (soft, mostly day with small night area for city lights) -->
          <rect
            x="0"
            y="0"
            width="400"
            height="400"
            fill="url(#nightGrad)"
            filter="url(#terminatorBlur)"
            style="mix-blend-mode: multiply"
          />

          <!-- City lights with subtle glow blur -->
          <g filter="url(#lightsBlur)">
            <image
              id="lights"
              href="https://www.solarsystemscope.com/textures/download/8k_earth_nightmap.jpg"
              filter="url(#conform)"
              x="-100%"
              y="-13%"
              width="200%"
              height="100%"
              preserveAspectRatio="none"
              style="mix-blend-mode: screen"
            />
          </g>

          <!-- Fixed realism overlays -->
          <g>
            <circle
              cx="200"
              cy="200"
              r="200"
              fill="url(#limbGrad)"
              style="mix-blend-mode: multiply"
            />
            <circle
              cx="200"
              cy="200"
              r="200"
              fill="url(#specGrad)"
              filter="url(#specBlur)"
              style="mix-blend-mode: screen"
            />
            <circle
              cx="200"
              cy="200"
              r="210"
              fill="url(#atmoGrad)"
              filter="url(#atmoBlur)"
            />
          </g>
        </svg>
      </div>

      <div class="controls">
        <div>
          <label for="scaleSlider"
            >Displacement Scale (Spherical Intensity)</label
          >
          <input
            type="range"
            id="scaleSlider"
            min="-200"
            max="200"
            value="55"
          />
          <div id="scaleVal">55</div>
        </div>

        <div>
          <label for="cloudSpeed"
            >Cloud Rotation Speed (relative to ground)</label
          >
          <input
            type="range"
            id="cloudSpeed"
            min="-2"
            max="2"
            step="0.01"
            value="0.70"
          />
          <div id="cloudSpeedVal">0.70x</div>
        </div>

        <button id="toggleAnim">Pause Rotation</button>
      </div>
    </div>

    <script>
      const slider = document.getElementById("scaleSlider");
      const cloudSpeedSlider = document.getElementById("cloudSpeed");
      const dispMap = document.getElementById("dispMap");
      const cloudDisp = document.getElementById("cloudDisp");
      const valDisplay = document.getElementById("scaleVal");
      const cloudSpeedVal = document.getElementById("cloudSpeedVal");
      const mapImage = document.getElementById("map");
      const clouds = document.getElementById("clouds");
      const lights = document.getElementById("lights");
      const toggleBtn = document.getElementById("toggleAnim");
      const svg = document.querySelector("#glass svg");

      let groundOffset = -100;
      let cloudOffset = -100;
      let cloudMultiplier = 0.7;
      let isAnimating = true;

      slider.addEventListener("input", (e) => {
        const val = e.target.value;
        dispMap.setAttribute("scale", val);
        cloudDisp.setAttribute("scale", Math.round(val * 0.8));
        valDisplay.textContent = val;
      });

      cloudSpeedSlider.addEventListener("input", (e) => {
        cloudMultiplier = parseFloat(e.target.value);
        cloudSpeedVal.textContent = cloudMultiplier.toFixed(2) + "x";
      });

      toggleBtn.addEventListener("click", () => {
        isAnimating = !isAnimating;
        toggleBtn.textContent = isAnimating
          ? "Pause Rotation"
          : "Resume Rotation";
      });

      // Twinkling stars
      function addStars(num = 150) {
        for (let i = 0; i < num; i++) {
          const star = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "circle"
          );
          star.setAttribute("cx", Math.random() * 400);
          star.setAttribute("cy", Math.random() * 400);
          star.setAttribute("r", Math.random() * 1.2 + 0.4);
          star.setAttribute("fill", "#ffffff");
          const baseOpacity = Math.random() * 0.5 + 0.3;
          star.style.opacity = baseOpacity;
          const duration = Math.random() * 4 + 3;
          star.style.animation = `twinkle ${duration}s ease-in-out infinite`;
          star.style.animationDelay = `-${Math.random() * duration}s`;
          svg.appendChild(star);
        }
      }

      //   addStars();

      function animate() {
        if (isAnimating) {
          groundOffset += 0.15;
          if (groundOffset >= 0) groundOffset = -100;

          cloudOffset += 0.15 * cloudMultiplier;
          if (cloudOffset >= 0) cloudOffset = -100;

          mapImage.setAttribute("x", `${groundOffset}%`);
          lights.setAttribute("x", `${groundOffset}%`);
          clouds.setAttribute("x", `${cloudOffset}%`);
        }
        requestAnimationFrame(animate);
      }

      requestAnimationFrame(animate);
    </script>
  </body>
</html>
